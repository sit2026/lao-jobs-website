{% extends 'accounts/auth_base.html' %}

{% block title %}ເຂົ້າສູ່ລະບົບ - Lao Jobs{% endblock %}

{% block nav_buttons %}
<a href="{% url 'accounts:register' %}" class="btn btn-nav btn-nav-primary">ລົງທະບຽນ</a>
{% endblock %}

{% block content %}
<div class="auth-card">
    <!-- Header -->
    <div class="auth-header">
        <div class="auth-icon">
            <i class="fas fa-user"></i>
        </div>
        <h1 class="auth-title">ເຂົ້າສູ່ລະບົບ</h1>
        <p class="auth-subtitle">ຍິນດີຕ້ອນຮັບກັບຄືນ! ກະລຸນາເຂົ້າສູ່ລະບົບ</p>
    </div>

    <!-- Error Message -->
    {% if form.errors %}
    <div class="alert-error">
        <i class="fas fa-exclamation-circle"></i>
        {% if form.non_field_errors %}
            {{ form.non_field_errors.0 }}
        {% else %}
            ອີເມວ ຫຼື ລະຫັດຜ່ານບໍ່ຖືກຕ້ອງ
        {% endif %}
    </div>
    {% endif %}

    <!-- Login Form -->
    <form method="POST" novalidate>
        {% csrf_token %}

        <!-- Email Field -->
        <div class="mb-3">
            <label for="id_email" class="form-label">ອີເມວ</label>
            <div class="input-group">
                <span class="input-group-text">
                    <i class="fas fa-envelope"></i>
                </span>
                <input
                    type="email"
                    name="email"
                    id="id_email"
                    class="form-control {% if form.email.errors %}is-invalid{% endif %}"
                    placeholder="example@email.com"
                    value="{{ form.email.value|default:'' }}"
                    required
                    autofocus
                >
            </div>
            {% if form.email.errors %}
            <div class="text-danger small mt-1">{{ form.email.errors.0 }}</div>
            {% endif %}
        </div>

        <!-- Password Field -->
        <div class="mb-3">
            <div class="d-flex justify-content-between align-items-center">
                <label for="id_password" class="form-label">ລະຫັດຜ່ານ</label>
                <a href="#" class="auth-link small">ລືມລະຫັດຜ່ານ?</a>
            </div>
            <div class="position-relative">
                <div class="input-group">
                    <span class="input-group-text">
                        <i class="fas fa-lock"></i>
                    </span>
                    <input
                        type="password"
                        name="password"
                        id="id_password"
                        class="form-control {% if form.password.errors %}is-invalid{% endif %}"
                        placeholder="ລະຫັດຜ່ານຂອງທ່ານ"
                        required
                    >
                </div>
                <button type="button" class="password-toggle" onclick="togglePassword()" style="right: 12px; top: 50%; transform: translateY(-50%); position: absolute;">
                    <i class="fas fa-eye" id="toggleIcon"></i>
                </button>
            </div>
            {% if form.password.errors %}
            <div class="text-danger small mt-1">{{ form.password.errors.0 }}</div>
            {% endif %}
        </div>

        <!-- Remember Me -->
        <div class="form-check mb-4">
            <input
                type="checkbox"
                name="remember_me"
                id="id_remember_me"
                class="form-check-input"
                {% if form.remember_me.value %}checked{% endif %}
            >
            <label for="id_remember_me" class="form-check-label">ຈຳຂ້ອຍໄວ້</label>
        </div>

        <!-- Submit Button -->
        <button type="submit" class="btn-submit">
            <i class="fas fa-sign-in-alt me-2"></i>ເຂົ້າສູ່ລະບົບ
        </button>
    </form>

    <!-- Divider -->
    <div class="divider">
        <span>ຫຼື</span>
    </div>

    <!-- Register Link -->
    <p class="text-center-muted">
        ຍັງບໍ່ມີບັນຊີ?
        <a href="{% url 'accounts:register' %}" class="auth-link">ລົງທະບຽນດຽວນີ້</a>
    </p>
</div>

<script>
function togglePassword() {
    const passwordField = document.getElementById('id_password');
    const toggleIcon = document.getElementById('toggleIcon');

    if (passwordField.type === 'password') {
        passwordField.type = 'text';
        toggleIcon.classList.remove('fa-eye');
        toggleIcon.classList.add('fa-eye-slash');
    } else {
        passwordField.type = 'password';
        toggleIcon.classList.remove('fa-eye-slash');
        toggleIcon.classList.add('fa-eye');
    }
}
</script>
{% endblock %}
